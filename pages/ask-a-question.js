import React,{useState, useEffect} from 'react'
import Head from 'next/head'
import Image from 'next/image'
import { Inter } from 'next/font/google'
import axios from 'axios'

const inter = Inter({ subsets: ['latin'] })

export default function Question() {
    const [loading, setLoading] = useState(false)
    const [response, setResponse] = useState('')
    const [question, setQuestion] = useState('')

    const handleChange = (event) => {
        // ðŸ‘‡ Get input value from "event"
        setQuestion(event.target.value);
    };

    const faireUneRequete = async () => {
        // setLoading(true)
        console.log("question",question);
        const url = "http://localhost:3500/prompt"

        fetch("http://localhost:3500/prompt", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            "ask": question
        })
        }).then(function(response) {
        return response.json();
        }).then(function(responseData){
        console.log("responseData",responseData)
        setResponse(responseData.response)
        }).finally(() =>{
            console.log(response)
         });
        
        // setLoading(false)
        console.log("===============================")
        console.log(response.data);
        console.log("===============================")
    }

  return (
    <>
      <Head>
        <title>AutoAIQ</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous"></link>
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main>
        <div>
          {loading ?(
            <h2>LOADING</h2>
          ):(
            <div className="container">
            <h2 className='text-center'>AUTO AIQ</h2>
            <br />
            <h6>Description : AUTO AIQ est une application web qui vous permet de poser toutes vos questions relative au document qui a Ã©tÃ© chargÃ© afin d'avoir des reponses.</h6>
            <br />
            <form className='form-group'>

                <label htmlFor="requete">Ã‰mettre une requÃªte :</label>
                <textarea className='form-control' onChange={handleChange} id="requete" name="requete" rows="5" required></textarea>
                <br />
                <button className='btn btn-primary' type="button" onClick={faireUneRequete}>Soumettre</button>
                <br />
                <br />
                <label htmlFor="reponse">RÃ©ponse de la requÃªte Ã©mise :</label>
                <textarea className='form-control' value={response} onChange={text => setResponse(text)} id="reponse" name="reponse" rows="15" required></textarea>
                <br />
            </form>
         </div>
          )}
        </div>
      </main>
    </>
  )
}
